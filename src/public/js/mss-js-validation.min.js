const csrfToken=$('meta[name="csrf-token"]').attr("content");function validate(e){e.select2=!!e.select2,e.submit=!!e.submit,e.fileValidate=!!e.fileValidate;let{rules:l}=e;return new Promise((s,r)=>{let t=getFormData(e);t.append("rules",JSON.stringify(l)),$.ajax({type:"POST",url:e.url,processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":csrfToken},data:t,success(l){handleSuccess(e),e.submit&&$("form").submit(),s(l)},error(l){console.log(l),handleError(e,l.responseJSON.errors),r(l)}})})}function validateNew(e){let{rules:l,messages:s,submit:r}=e;return new Promise((t,n)=>{let a=getFormData(e);a.append("rules",JSON.stringify(l)),a.append("messages",JSON.stringify(s)),$.ajax({type:"POST",url:"/mss-validation/validate",processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":csrfToken},data:a,success(l){handleSuccess(e),r&&$("form").submit(),t(l)},error(l){console.log(l),handleError(e,l.responseJSON.errors),n(l)}})})}function getFormData(e){let{keys:l,fileValidate:s}=e,r=new FormData;return l.forEach(function(e){let l=$('[name="'+e+'"]');if(l.length>0){if(l.is(":radio")){let t=$('[name="'+e+'"]:checked');t.length>0&&r.append(e,t.val())}else if(l.is(":file")&&s){var n=l[0].files[0];n&&r.append(e,n)}else l.is(":checkbox")?r.append(e,l.prop("checked")):r.append(e,l.val())}else{let a=$('[name="'+e+'[]"]');a.length>0&&r.append(e,a.val())}}),r}function handleSuccess(e){let{keys:l,select2:s}=e;l.forEach(e=>{let l=$('[name="'+e+'"]');if(l.length>0){(l=resolveElm(l)).is("select")&&l.hasClass("select2")&&s&&(el=resolveElm(el=(parent=l.parent()).find(".select2-selection.select2-selection--single"))),l.is(":file")&&l.hasClass("dropify")&&(el=resolveElm(el=(parent=l.parent().parent()).find(".dropify-wrapper")));let r=$(`.${e}-err`);r.length>0&&r.remove()}else{let t=$('[name="'+e+'[]"]');if(t.length>0){parent=t.parent(),(el=t.prop("multiple")?parent.find(".select2-selection.select2-selection--multiple"):parent.find(".select2-selection.select2-selection--single")).length>0&&(el=resolveElm(el));let n=$(`.${e}-err`);n.length>0&&n.remove()}}})}function handleError(e,l){let{keys:s,select2:r}=e,t=Object.keys(l),n=s.filter(e=>!t.includes(e));for(let a in l){let i=$('[name="'+a+'"]'),o;var c=$("<small>",{class:`text-danger mt-3 me-3 ${a}-err`,text:l[a][0]});if(i.length>0){(i=errorElm(i)).is(":radio")?o=$('[name="'+a+'"]:checked').parent().parent():i.is("select")&&i.hasClass("select2")&&r?el=errorElm(el=(o=i.parent()).find(".select2-selection.select2-selection--single")):i.is(":file")&&i.hasClass("dropify")?el=errorElm(el=(o=i.parent().parent()).find(".dropify-wrapper")):o=(o=i.parent()).hasClass("input-group")?o.parent():o;let p=$(`.${a}-err`);p.length>0&&p.remove(),o.append(c)}else{let m=$('[name="'+a+'[]"]');if(m.length>0){o=(m=errorElm(m)).parent(),(el=m.prop("multiple")?o.find(".select2-selection.select2-selection--multiple"):o.find(".select2-selection.select2-selection--single")).length>0&&(el=errorElm(el));let f=$(`.${a}-err`);f.length>0&&f.remove(),o.append(c)}}}n.forEach(e=>{let l=$('[name="'+e+'"]');if(l.length>0){(l=resolveElm(l)).is("select")&&l.hasClass("select2")&&r&&(el=resolveElm(el=(parent=l.parent()).find(".select2-selection.select2-selection--single"))),l.is(":file")&&l.hasClass("dropify")&&(el=resolveElm(el=(parent=l.parent().parent()).find(".dropify-wrapper")));let s=$(`.${e}-err`);s.length>0&&s.remove()}else{let t=$('[name="'+e+'[]"]');if(t.length>0){parent=(t=resolveElm(t)).parent(),(el=t.prop("multiple")?parent.find(".select2-selection.select2-selection--multiple"):parent.find(".select2-selection.select2-selection--single")).length>0&&(el=resolveElm(el));let n=$(`.${e}-err`);n.length>0&&n.remove()}}})}function resolveElm(e){return e.hasClass("resolve")||e.addClass("resolve"),e.hasClass("error")&&e.removeClass("error"),e}function errorElm(e){return e.hasClass("error")||e.addClass("error"),e.hasClass("resolve")&&e.removeClass("resolve"),e}